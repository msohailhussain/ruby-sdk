-#
-# Copyright 2017, Optimizely and contributors
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-#    http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-#

.container
  / Example row of columns
  = render "shared/tabs"
  .row
    = link_to 'Clear cart',
    delete_cart_path,
    method: :delete,
    data: { confirm: 'Are you sure? want to delete all items!' },
    class:"btn btn-danger #{!@cart.present? ? 'disabled' : ''}"
  %br
  .row
    %table#example.table.table-sm
      %thead
        %tr
          %th Products
          %th Quantity
          %th Price
      %tbody
        - sum = 0
        - qty = 0
        - @cart.each do |key,value|
          - sum+=(value * Product.find(key)[:price])
          - qty = value * Product.find(key)[:price]
          %tr
            %td
              = "#{Product.find(key)[:name]}"
            %td
              = "#{value}"
            %td
              = "$ #{qty}"
        %tr
          %td Total
          %td
            = "#{Cart.total_qty.to_i}"
          %td
            = "$ #{sum}"
    -if @cart.present?
      - if @enabled
        = link_to "Buy Now",
          checkout_cart_path(user_id: session[:user_id]),
          method: :get, class:"btn btn-info"
      - else
        = link_to "Checkout",
          checkout_complete_path(user_id: session[:user_id]),
          method: :post, class:"btn btn-info"